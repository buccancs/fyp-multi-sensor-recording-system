<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Sensor Recording Dashboard - Settings</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Socket.IO for real-time communication -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --danger-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            --card-gradient: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            color: #1a202c;
        }
        
        .main-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            margin: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .navbar {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            margin: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-weight: bold;
            color: white !important;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.9) !important;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: white !important;
            transform: translateY(-1px);
        }
        
        .nav-link.active {
            color: white !important;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 24px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 48px rgba(0,0,0,0.15);
        }
        
        .card-header {
            background: rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px 20px 0 0 !important;
            font-weight: 600;
            color: #1a202c;
        }
        
        .btn-primary {
            background: var(--primary-gradient);
            border: none;
            border-radius: 12px;
            font-weight: 600;
            padding: 12px 24px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }
        
        .btn-success {
            background: var(--success-gradient);
            border: none;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .btn-warning {
            background: var(--warning-gradient);
            border: none;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .btn-danger {
            background: var(--danger-gradient);
            border: none;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .form-control, .form-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #1a202c;
            backdrop-filter: blur(10px);
            font-weight: 500;
        }
        
        .form-control:focus, .form-select:focus {
            background: rgba(255, 255, 255, 0.2);
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            color: #1a202c;
        }
        
        .form-check-input:checked {
            background-color: #667eea;
            border-color: #667eea;
        }
        
        .form-check-input:focus {
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.4);
        }
        
        .form-range::-webkit-slider-thumb {
            background: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
        }
        
        .form-range::-moz-range-thumb {
            background: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
        }
        
        .settings-nav {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 20px;
        }
        
        .settings-nav .nav-link {
            color: #1a202c !important;
            font-weight: 500;
            border-radius: 8px;
            margin: 4px;
            transition: all 0.3s ease;
        }
        
        .settings-nav .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: none;
        }
        
        .settings-nav .nav-link.active {
            background: var(--primary-gradient);
            color: white !important;
        }
        
        .alert {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        
        .alert-success {
            border-left: 4px solid #10b981;
        }
        
        .alert-warning {
            border-left: 4px solid #f59e0b;
        }
        
        .alert-info {
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <i class="fas fa-video me-2"></i>Multi-Sensor Recording
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">
                            <i class="fas fa-tachometer-alt me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/devices">
                            <i class="fas fa-mobile-alt me-1"></i>Devices
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/sessions">
                            <i class="fas fa-folder me-1"></i>Sessions
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/playback">
                            <i class="fas fa-play me-1"></i>Playback
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/files">
                            <i class="fas fa-file me-1"></i>Files
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/settings">
                            <i class="fas fa-cog me-1"></i>Settings
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="row">
            <!-- Settings Navigation -->
            <div class="col-md-3">
                <div class="settings-nav">
                    <div class="nav flex-column nav-pills p-3" role="tablist">
                        <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#device-settings" role="tab">
                            <i class="fas fa-mobile-alt me-2"></i>Device Configuration
                        </button>
                        <button class="nav-link" data-bs-toggle="pill" data-bs-target="#recording-settings" role="tab">
                            <i class="fas fa-record-vinyl me-2"></i>Recording Settings
                        </button>
                        <button class="nav-link" data-bs-toggle="pill" data-bs-target="#display-settings" role="tab">
                            <i class="fas fa-desktop me-2"></i>Display Settings
                        </button>
                        <button class="nav-link" data-bs-toggle="pill" data-bs-target="#network-settings" role="tab">
                            <i class="fas fa-network-wired me-2"></i>Network Settings
                        </button>
                        <button class="nav-link" data-bs-toggle="pill" data-bs-target="#export-settings" role="tab">
                            <i class="fas fa-download me-2"></i>Export Settings
                        </button>
                        <button class="nav-link" data-bs-toggle="pill" data-bs-target="#system-settings" role="tab">
                            <i class="fas fa-cogs me-2"></i>System Settings
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Settings Content -->
            <div class="col-md-9">
                <div class="tab-content">
                    <!-- Device Configuration -->
                    <div class="tab-pane fade show active" id="device-settings" role="tabpanel">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-mobile-alt me-2"></i>Device Configuration</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Server Port</label>
                                            <input type="number" class="form-control" value="8080" min="1000" max="65535">
                                            <div class="form-text">Port for device connections (1000-65535)</div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Connection Timeout (seconds)</label>
                                            <input type="number" class="form-control" value="30" min="5" max="300">
                                            <div class="form-text">Timeout for device connections</div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Max Concurrent Devices</label>
                                            <select class="form-select">
                                                <option value="5">5 devices</option>
                                                <option value="10" selected>10 devices</option>
                                                <option value="20">20 devices</option>
                                                <option value="50">50 devices</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Auto-Connection Options</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="autoConnect">
                                                <label class="form-check-label" for="autoConnect">
                                                    Auto-connect to known devices
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="autoReconnect">
                                                <label class="form-check-label" for="autoReconnect">
                                                    Auto-reconnect on connection loss
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="deviceNotifications">
                                                <label class="form-check-label" for="deviceNotifications">
                                                    Show device connection notifications
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="alert alert-info">
                                            <i class="fas fa-info-circle me-2"></i>
                                            <strong>Current Status:</strong> Server running on port 8080 with 6 connected devices
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recording Settings -->
                    <div class="tab-pane fade" id="recording-settings" role="tabpanel">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-record-vinyl me-2"></i>Recording Configuration</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Output Directory</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" value="./recordings" readonly>
                                                <button class="btn btn-primary" type="button">
                                                    <i class="fas fa-folder-open"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Video Quality</label>
                                            <select class="form-select">
                                                <option value="low">Low (480p)</option>
                                                <option value="medium">Medium (720p)</option>
                                                <option value="high" selected>High (1080p)</option>
                                                <option value="ultra">Ultra (4K)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Sample Rate (Hz)</label>
                                            <input type="range" class="form-range" min="10" max="1000" value="100" id="sampleRateSlider">
                                            <div class="d-flex justify-content-between">
                                                <small>10 Hz</small>
                                                <span id="sampleRateValue" class="fw-semibold">100 Hz</span>
                                                <small>1000 Hz</small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Recording Options</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="compressRecordings">
                                                <label class="form-check-label" for="compressRecordings">
                                                    Compress recordings to save space
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="createBackups">
                                                <label class="form-check-label" for="createBackups">
                                                    Create backup copies
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="addTimestamps">
                                                <label class="form-check-label" for="addTimestamps">
                                                    Add timestamps to filenames
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="autoStopOnError">
                                                <label class="form-check-label" for="autoStopOnError">
                                                    Auto-stop recording on errors
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="alert alert-warning">
                                            <i class="fas fa-exclamation-triangle me-2"></i>
                                            <strong>Storage Space:</strong> 2.3 GB remaining on selected drive
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Display Settings -->
                    <div class="tab-pane fade" id="display-settings" role="tabpanel">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-desktop me-2"></i>Display Configuration</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">UI Theme</label>
                                            <select class="form-select">
                                                <option value="modern" selected>Modern (Default)</option>
                                                <option value="dark">Dark</option>
                                                <option value="light">Light</option>
                                                <option value="high-contrast">High Contrast</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Preview Resolution</label>
                                            <select class="form-select">
                                                <option value="640x480">640x480</option>
                                                <option value="800x600">800x600</option>
                                                <option value="1024x768">1024x768</option>
                                                <option value="1280x720" selected>1280x720</option>
                                                <option value="1920x1080">1920x1080</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Preview FPS</label>
                                            <input type="number" class="form-control" value="30" min="10" max="60">
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Display Options</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="fullscreenStimulus">
                                                <label class="form-check-label" for="fullscreenStimulus">
                                                    Use fullscreen for stimulus presentation
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="showDataOverlay">
                                                <label class="form-check-label" for="showDataOverlay">
                                                    Show data overlay on preview
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="showFPS">
                                                <label class="form-check-label" for="showFPS">
                                                    Show FPS counter
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="smoothAnimations">
                                                <label class="form-check-label" for="smoothAnimations">
                                                    Enable smooth animations
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Network Settings -->
                    <div class="tab-pane fade" id="network-settings" role="tabpanel">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-network-wired me-2"></i>Network Configuration</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Network Interface</label>
                                            <select class="form-select">
                                                <option value="auto" selected>Auto-detect</option>
                                                <option value="wifi">Wi-Fi (192.168.1.100)</option>
                                                <option value="ethernet">Ethernet (192.168.0.100)</option>
                                                <option value="localhost">Localhost (127.0.0.1)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Buffer Size (MB)</label>
                                            <input type="number" class="form-control" value="64" min="16" max="512">
                                            <div class="form-text">Network buffer for data transmission</div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Compression Level</label>
                                            <input type="range" class="form-range" min="0" max="9" value="6" id="compressionSlider">
                                            <div class="d-flex justify-content-between">
                                                <small>None</small>
                                                <span id="compressionValue" class="fw-semibold">Medium</span>
                                                <small>Maximum</small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Security Settings</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="enableSSL">
                                                <label class="form-check-label" for="enableSSL">
                                                    Enable SSL/TLS encryption
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="requireAuth">
                                                <label class="form-check-label" for="requireAuth">
                                                    Require device authentication
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="logConnections">
                                                <label class="form-check-label" for="logConnections">
                                                    Log all connection attempts
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="alert alert-success">
                                            <i class="fas fa-check-circle me-2"></i>
                                            <strong>Network Status:</strong> Connected and operational
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Export Settings -->
                    <div class="tab-pane fade" id="export-settings" role="tabpanel">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-download me-2"></i>Export Configuration</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Default Export Format</label>
                                            <select class="form-select">
                                                <option value="csv" selected>CSV (Comma Separated Values)</option>
                                                <option value="json">JSON (JavaScript Object Notation)</option>
                                                <option value="hdf5">HDF5 (Hierarchical Data Format)</option>
                                                <option value="matlab">MATLAB (.mat files)</option>
                                                <option value="excel">Excel (.xlsx files)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Video Export Format</label>
                                            <select class="form-select">
                                                <option value="mp4" selected>MP4 (H.264)</option>
                                                <option value="avi">AVI (Uncompressed)</option>
                                                <option value="mov">MOV (QuickTime)</option>
                                                <option value="webm">WebM (VP9)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Export Directory</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" value="./exports" readonly>
                                                <button class="btn btn-primary" type="button">
                                                    <i class="fas fa-folder-open"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Export Options</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="includeMetadata">
                                                <label class="form-check-label" for="includeMetadata">
                                                    Include metadata in export
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="includeTimestamps">
                                                <label class="form-check-label" for="includeTimestamps">
                                                    Include timestamps
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="separateDevices">
                                                <label class="form-check-label" for="separateDevices">
                                                    Separate files per device
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="compressExports">
                                                <label class="form-check-label" for="compressExports">
                                                    Compress exported files
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- System Settings -->
                    <div class="tab-pane fade" id="system-settings" role="tabpanel">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>System Configuration</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Log Level</label>
                                            <select class="form-select">
                                                <option value="debug">Debug (Verbose)</option>
                                                <option value="info" selected>Info (Normal)</option>
                                                <option value="warning">Warning (Errors only)</option>
                                                <option value="error">Error (Critical only)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Auto-save Interval (minutes)</label>
                                            <input type="number" class="form-control" value="5" min="1" max="60">
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">Memory Usage Limit (%)</label>
                                            <input type="range" class="form-range" min="50" max="95" value="80" id="memorySlider">
                                            <div class="d-flex justify-content-between">
                                                <small>50%</small>
                                                <span id="memoryValue" class="fw-semibold">80%</span>
                                                <small>95%</small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-semibold">System Options</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="startWithSystem">
                                                <label class="form-check-label" for="startWithSystem">
                                                    Start with system boot
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="checkUpdates">
                                                <label class="form-check-label" for="checkUpdates">
                                                    Check for updates automatically
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked id="sendUsageStats">
                                                <label class="form-check-label" for="sendUsageStats">
                                                    Send anonymous usage statistics
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-warning" id="clearCacheBtn">
                                                <i class="fas fa-trash me-2"></i>Clear Cache
                                            </button>
                                            <button class="btn btn-danger" id="resetAllBtn">
                                                <i class="fas fa-undo me-2"></i>Reset All Settings
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="card mt-4">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <button class="btn btn-success me-2" id="saveAllBtn">
                                    <i class="fas fa-save me-2"></i>Save All Settings
                                </button>
                                <button class="btn btn-warning me-2" id="exportConfigBtn">
                                    <i class="fas fa-download me-2"></i>Export Configuration
                                </button>
                                <button class="btn btn-primary" id="importConfigBtn">
                                    <i class="fas fa-upload me-2"></i>Import Configuration
                                </button>
                            </div>
                            <div>
                                <button class="btn btn-secondary" id="restoreDefaultsBtn">
                                    <i class="fas fa-undo me-2"></i>Restore Defaults
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Initialize settings functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Sample rate slider
            const sampleRateSlider = document.getElementById('sampleRateSlider');
            const sampleRateValue = document.getElementById('sampleRateValue');
            
            sampleRateSlider.addEventListener('input', function() {
                sampleRateValue.textContent = this.value + ' Hz';
            });
            
            // Compression slider
            const compressionSlider = document.getElementById('compressionSlider');
            const compressionValue = document.getElementById('compressionValue');
            const compressionLabels = ['None', 'Low', 'Low', 'Medium', 'Medium', 'Medium', 'High', 'High', 'Very High', 'Maximum'];
            
            compressionSlider.addEventListener('input', function() {
                compressionValue.textContent = compressionLabels[this.value];
            });
            
            // Memory slider
            const memorySlider = document.getElementById('memorySlider');
            const memoryValue = document.getElementById('memoryValue');
            
            memorySlider.addEventListener('input', function() {
                memoryValue.textContent = this.value + '%';
            });
            
            // Save all settings
            document.getElementById('saveAllBtn').addEventListener('click', function() {
                // Show success message
                const alert = document.createElement('div');
                alert.className = 'alert alert-success mt-3';
                alert.innerHTML = '<i class="fas fa-check-circle me-2"></i>All settings saved successfully!';
                document.querySelector('.main-content').appendChild(alert);
                
                // Remove alert after 3 seconds
                setTimeout(() => {
                    alert.remove();
                }, 3000);
            });
            
            // Reset all settings
            document.getElementById('resetAllBtn').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset all settings to defaults? This action cannot be undone.')) {
                    // Reset form values
                    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    document.querySelectorAll('select').forEach(select => {
                        select.selectedIndex = 0;
                    });
                    
                    alert('Settings have been reset to defaults.');
                }
            });
            
            // Clear cache
            document.getElementById('clearCacheBtn').addEventListener('click', function() {
                if (confirm('Clear all cached data? This may improve performance.')) {
                    alert('Cache cleared successfully.');
                }
            });
        });
    </script>
</body>
</html>
            padding: 0;
        }
        
        .settings-nav .nav-link {
            color: #495057;
            border-radius: 8px;
            margin: 5px;
            transition: all 0.2s;
        }
        
        .settings-nav .nav-link:hover {
            background-color: #e9ecef;
            color: var(--primary-color);
        }
        
        .settings-nav .nav-link.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .settings-section {
            padding: 20px;
        }
        
        .setting-item {
            border-bottom: 1px solid #f1f3f4;
            padding: 15px 0;
        }
        
        .setting-item:last-child {
            border-bottom: none;
        }
        
        .setting-label {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .setting-description {
            color: #6c757d;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        
        .color-picker {
            width: 50px;
            height: 35px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .device-config {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-ok {
            background-color: var(--success-color);
        }
        
        .status-warning {
            background-color: var(--warning-color);
        }
        
        .status-error {
            background-color: var(--danger-color);
        }
        
        .backup-item {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background-color: #fff;
        }
        
        .real-time-indicator {
            position: fixed;
            top: 70px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 1000;
        }
        
        .real-time-indicator.disconnected {
            background: var(--danger-color);
        }
        
        @media (max-width: 768px) {
            .settings-nav {
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-chart-line me-2"></i>
                Multi-Sensor Recording Dashboard
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">
                            <i class="fas fa-tachometer-alt me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/devices">
                            <i class="fas fa-devices me-1"></i>Devices
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/sessions">
                            <i class="fas fa-history me-1"></i>Sessions
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/playback">
                            <i class="fas fa-play me-1"></i>Playback
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/files">
                            <i class="fas fa-folder me-1"></i>File Viewer
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/settings">
                            <i class="fas fa-cog me-1"></i>Settings
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- Real-time connection indicator -->
    <div id="connectionIndicator" class="real-time-indicator">
        <i class="fas fa-wifi me-1"></i>
        <span id="connectionStatus">Connected</span>
    </div>
    
    <div class="container mt-4">
        <div class="row">
            <!-- Settings Navigation -->
            <div class="col-lg-3 col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-list me-2"></i>Settings Categories
                        </h5>
                    </div>
                    <div class="card-body p-0">
                        <nav class="nav nav-pills flex-column settings-nav">
                            <a class="nav-link active" href="#general" onclick="showSection('general')">
                                <i class="fas fa-cog me-2"></i>General
                            </a>
                            <a class="nav-link" href="#recording" onclick="showSection('recording')">
                                <i class="fas fa-record-vinyl me-2"></i>Recording
                            </a>
                            <a class="nav-link" href="#devices" onclick="showSection('devices')">
                                <i class="fas fa-devices me-2"></i>Device Settings
                            </a>
                            <a class="nav-link" href="#network" onclick="showSection('network')">
                                <i class="fas fa-network-wired me-2"></i>Network
                            </a>
                            <a class="nav-link" href="#calibration" onclick="showSection('calibration')">
                                <i class="fas fa-crosshairs me-2"></i>Calibration
                            </a>
                            <a class="nav-link" href="#storage" onclick="showSection('storage')">
                                <i class="fas fa-hdd me-2"></i>Storage
                            </a>
                            <a class="nav-link" href="#backup" onclick="showSection('backup')">
                                <i class="fas fa-shield-alt me-2"></i>Backup & Security
                            </a>
                            <a class="nav-link" href="#advanced" onclick="showSection('advanced')">
                                <i class="fas fa-wrench me-2"></i>Advanced
                            </a>
                        </nav>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-bolt me-2"></i>Quick Actions
                        </h6>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-outline-success w-100 mb-2" onclick="saveAllSettings()">
                            <i class="fas fa-save me-1"></i>Save All Settings
                        </button>
                        <button class="btn btn-outline-warning w-100 mb-2" onclick="resetToDefaults()">
                            <i class="fas fa-undo me-1"></i>Reset to Defaults
                        </button>
                        <button class="btn btn-outline-info w-100 mb-2" onclick="exportSettings()">
                            <i class="fas fa-download me-1"></i>Export Settings
                        </button>
                        <button class="btn btn-outline-secondary w-100" onclick="importSettings()">
                            <i class="fas fa-upload me-1"></i>Import Settings
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Settings Content -->
            <div class="col-lg-9 col-md-8">
                <!-- General Settings -->
                <div id="generalSection" class="settings-section">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-cog me-2"></i>General Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="setting-item">
                                <div class="setting-label">Application Theme</div>
                                <div class="setting-description">Choose the color theme for the interface</div>
                                <select class="form-select" id="theme" onchange="updateSetting('theme', this.value)">
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                    <option value="auto">Auto (system preference)</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Language</div>
                                <div class="setting-description">Select the interface language</div>
                                <select class="form-select" id="language" onchange="updateSetting('language', this.value)">
                                    <option value="en">English</option>
                                    <option value="es">Espaol</option>
                                    <option value="fr">Franais</option>
                                    <option value="de">Deutsch</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Auto-save Interval</div>
                                <div class="setting-description">Automatically save settings every N minutes</div>
                                <input type="number" class="form-control" id="autosaveInterval" value="5" min="1" max="60" 
                                       onchange="updateSetting('autosaveInterval', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Show Notifications</div>
                                <div class="setting-description">Display system notifications for important events</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="notifications" checked
                                           onchange="updateSetting('notifications', this.checked)">
                                    <label class="form-check-label" for="notifications">Enable notifications</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Recording Settings -->
                <div id="recordingSection" class="settings-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-record-vinyl me-2"></i>Recording Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="setting-item">
                                <div class="setting-label">Default Recording Duration</div>
                                <div class="setting-description">Maximum duration for automatic recording sessions (minutes)</div>
                                <input type="number" class="form-control" id="recordingDuration" value="30" min="1" max="240"
                                       onchange="updateSetting('recordingDuration', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Video Quality</div>
                                <div class="setting-description">Default video recording quality</div>
                                <select class="form-select" id="videoQuality" onchange="updateSetting('videoQuality', this.value)">
                                    <option value="720p">720p HD</option>
                                    <option value="1080p" selected>1080p Full HD</option>
                                    <option value="4k">4K Ultra HD</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Audio Recording</div>
                                <div class="setting-description">Enable audio recording alongside video</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="audioRecording" checked
                                           onchange="updateSetting('audioRecording', this.checked)">
                                    <label class="form-check-label" for="audioRecording">Record audio</label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Auto-start Recording</div>
                                <div class="setting-description">Automatically start recording when all devices are connected</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="autoStartRecording"
                                           onchange="updateSetting('autoStartRecording', this.checked)">
                                    <label class="form-check-label" for="autoStartRecording">Enable auto-start</label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Compression Level</div>
                                <div class="setting-description">Video compression level (higher = smaller files, lower quality)</div>
                                <input type="range" class="form-range" id="compressionLevel" min="1" max="10" value="5"
                                       oninput="updateCompressionDisplay(this.value)" onchange="updateSetting('compressionLevel', this.value)">
                                <div class="d-flex justify-content-between">
                                    <small>Low compression</small>
                                    <small id="compressionValue">Medium (5)</small>
                                    <small>High compression</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Device Settings -->
                <div id="devicesSection" class="settings-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-devices me-2"></i>Device Configuration
                            </h5>
                        </div>
                        <div class="card-body">
                            <!-- Android Device Settings -->
                            <div class="device-config">
                                <h6><i class="fas fa-mobile-alt me-2"></i>Android Devices</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Connection Timeout (seconds)</label>
                                        <input type="number" class="form-control" id="androidTimeout" value="30" min="5" max="120"
                                               onchange="updateSetting('androidTimeout', this.value)">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Retry Attempts</label>
                                        <input type="number" class="form-control" id="androidRetries" value="3" min="1" max="10"
                                               onchange="updateSetting('androidRetries', this.value)">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="androidAutoReconnect" checked
                                               onchange="updateSetting('androidAutoReconnect', this.checked)">
                                        <label class="form-check-label" for="androidAutoReconnect">Auto-reconnect on disconnection</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Shimmer Sensor Settings -->
                            <div class="device-config">
                                <h6><i class="fas fa-heartbeat me-2"></i>Shimmer Sensors</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Sampling Rate (Hz)</label>
                                        <select class="form-select" id="shimmerSamplingRate" onchange="updateSetting('shimmerSamplingRate', this.value)">
                                            <option value="128">128 Hz</option>
                                            <option value="256" selected>256 Hz</option>
                                            <option value="512">512 Hz</option>
                                            <option value="1024">1024 Hz</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Battery Warning Level (%)</label>
                                        <input type="number" class="form-control" id="shimmerBatteryWarning" value="20" min="5" max="50"
                                               onchange="updateSetting('shimmerBatteryWarning', this.value)">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <label class="form-label">Enabled Sensors</label>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="shimmerGSR" checked
                                                       onchange="updateShimmerSensors()">
                                                <label class="form-check-label" for="shimmerGSR">GSR</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="shimmerAccel" checked
                                                       onchange="updateShimmerSensors()">
                                                <label class="form-check-label" for="shimmerAccel">Accelerometer</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="shimmerECG"
                                                       onchange="updateShimmerSensors()">
                                                <label class="form-check-label" for="shimmerECG">ECG</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- USB Webcam Settings -->
                            <div class="device-config">
                                <h6><i class="fas fa-video me-2"></i>USB Webcams</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Default Resolution</label>
                                        <select class="form-select" id="webcamResolution" onchange="updateSetting('webcamResolution', this.value)">
                                            <option value="640x480">640x480</option>
                                            <option value="1280x720">1280x720 (HD)</option>
                                            <option value="1920x1080" selected>1920x1080 (Full HD)</option>
                                            <option value="3840x2160">3840x2160 (4K)</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Frame Rate (FPS)</label>
                                        <select class="form-select" id="webcamFPS" onchange="updateSetting('webcamFPS', this.value)">
                                            <option value="15">15 FPS</option>
                                            <option value="30" selected>30 FPS</option>
                                            <option value="60">60 FPS</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Network Settings -->
                <div id="networkSection" class="settings-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-network-wired me-2"></i>Network Configuration
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="setting-item">
                                <div class="setting-label">Server Port</div>
                                <div class="setting-description">Port for device communication server</div>
                                <input type="number" class="form-control" id="serverPort" value="9000" min="1024" max="65535"
                                       onchange="updateSetting('serverPort', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Web Dashboard Port</div>
                                <div class="setting-description">Port for web dashboard interface</div>
                                <input type="number" class="form-control" id="webPort" value="5000" min="1024" max="65535"
                                       onchange="updateSetting('webPort', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Connection Timeout</div>
                                <div class="setting-description">Network connection timeout in seconds</div>
                                <input type="number" class="form-control" id="connectionTimeout" value="30" min="5" max="300"
                                       onchange="updateSetting('connectionTimeout', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Enable SSL/TLS</div>
                                <div class="setting-description">Use encrypted connections for security</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="enableSSL"
                                           onchange="updateSetting('enableSSL', this.checked)">
                                    <label class="form-check-label" for="enableSSL">Enable SSL/TLS encryption</label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Data Compression</div>
                                <div class="setting-description">Compress network data to reduce bandwidth usage</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="dataCompression" checked
                                           onchange="updateSetting('dataCompression', this.checked)">
                                    <label class="form-check-label" for="dataCompression">Enable data compression</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Calibration Settings -->
                <div id="calibrationSection" class="settings-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-crosshairs me-2"></i>Calibration Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="setting-item">
                                <div class="setting-label">Auto-calibration</div>
                                <div class="setting-description">Automatically run calibration when devices connect</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="autoCalibration"
                                           onchange="updateSetting('autoCalibration', this.checked)">
                                    <label class="form-check-label" for="autoCalibration">Enable auto-calibration</label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Calibration Pattern</div>
                                <div class="setting-description">Type of calibration pattern to use</div>
                                <select class="form-select" id="calibrationPattern" onchange="updateSetting('calibrationPattern', this.value)">
                                    <option value="checkerboard" selected>Checkerboard</option>
                                    <option value="circles">Circle Grid</option>
                                    <option value="apriltag">AprilTag</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Pattern Size</div>
                                <div class="setting-description">Size of calibration pattern squares (mm)</div>
                                <input type="number" class="form-control" id="patternSize" value="25" min="10" max="100"
                                       onchange="updateSetting('patternSize', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Minimum Calibration Images</div>
                                <div class="setting-description">Minimum number of images required for calibration</div>
                                <input type="number" class="form-control" id="minCalibrationImages" value="10" min="5" max="50"
                                       onchange="updateSetting('minCalibrationImages', this.value)">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Storage Settings -->
                <div id="storageSection" class="settings-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-hdd me-2"></i>Storage Configuration
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="setting-item">
                                <div class="setting-label">Default Storage Location</div>
                                <div class="setting-description">Default directory for recording files</div>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="storagePath" value="./recordings"
                                           onchange="updateSetting('storagePath', this.value)">
                                    <button class="btn btn-outline-secondary" onclick="browseStoragePath()">
                                        <i class="fas fa-folder-open"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Auto-cleanup</div>
                                <div class="setting-description">Automatically delete old files to free space</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="autoCleanup"
                                           onchange="updateSetting('autoCleanup', this.checked)">
                                    <label class="form-check-label" for="autoCleanup">Enable auto-cleanup</label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Cleanup Threshold</div>
                                <div class="setting-description">Delete files when disk usage exceeds this percentage</div>
                                <input type="number" class="form-control" id="cleanupThreshold" value="85" min="50" max="95"
                                       onchange="updateSetting('cleanupThreshold', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">File Retention Period</div>
                                <div class="setting-description">Keep files for this many days before cleanup</div>
                                <input type="number" class="form-control" id="retentionPeriod" value="30" min="7" max="365"
                                       onchange="updateSetting('retentionPeriod', this.value)">
                            </div>
                            
                            <div class="alert alert-info">
                                <h6><i class="fas fa-info-circle me-2"></i>Storage Status</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <small>Total Space:</small><br>
                                        <strong id="totalSpace">Loading...</strong>
                                    </div>
                                    <div class="col-md-4">
                                        <small>Used Space:</small><br>
                                        <strong id="usedSpace">Loading...</strong>
                                    </div>
                                    <div class="col-md-4">
                                        <small>Free Space:</small><br>
                                        <strong id="freeSpace">Loading...</strong>
                                    </div>
                                </div>
                                <div class="progress mt-2">
                                    <div class="progress-bar" id="storageProgressBar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Backup & Security Settings -->
                <div id="backupSection" class="settings-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-shield-alt me-2"></i>Backup & Security
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="setting-item">
                                <div class="setting-label">Auto-backup</div>
                                <div class="setting-description">Automatically backup settings and session data</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="autoBackup" checked
                                           onchange="updateSetting('autoBackup', this.checked)">
                                    <label class="form-check-label" for="autoBackup">Enable auto-backup</label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Backup Interval</div>
                                <div class="setting-description">How often to create automatic backups</div>
                                <select class="form-select" id="backupInterval" onchange="updateSetting('backupInterval', this.value)">
                                    <option value="daily" selected>Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Backup Location</div>
                                <div class="setting-description">Directory for storing backup files</div>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="backupPath" value="./backups"
                                           onchange="updateSetting('backupPath', this.value)">
                                    <button class="btn btn-outline-secondary" onclick="browseBackupPath()">
                                        <i class="fas fa-folder-open"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="mt-3">
                                <h6>Recent Backups</h6>
                                <div id="backupList">
                                    <!-- Backup list will be populated here -->
                                </div>
                                <button class="btn btn-primary me-2" onclick="createBackup()">
                                    <i class="fas fa-save me-1"></i>Create Backup Now
                                </button>
                                <button class="btn btn-outline-secondary" onclick="restoreBackup()">
                                    <i class="fas fa-upload me-1"></i>Restore from Backup
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced Settings -->
                <div id="advancedSection" class="settings-section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-wrench me-2"></i>Advanced Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <strong>Warning:</strong> These settings are for advanced users only. Changing these values may affect system stability.
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Debug Mode</div>
                                <div class="setting-description">Enable detailed logging for troubleshooting</div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="debugMode"
                                           onchange="updateSetting('debugMode', this.checked)">
                                    <label class="form-check-label" for="debugMode">Enable debug mode</label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Log Level</div>
                                <div class="setting-description">Minimum level for log messages</div>
                                <select class="form-select" id="logLevel" onchange="updateSetting('logLevel', this.value)">
                                    <option value="ERROR">Error</option>
                                    <option value="WARNING">Warning</option>
                                    <option value="INFO" selected>Info</option>
                                    <option value="DEBUG">Debug</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Memory Limit (MB)</div>
                                <div class="setting-description">Maximum memory usage before cleanup</div>
                                <input type="number" class="form-control" id="memoryLimit" value="1024" min="512" max="8192"
                                       onchange="updateSetting('memoryLimit', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Worker Threads</div>
                                <div class="setting-description">Number of worker threads for processing</div>
                                <input type="number" class="form-control" id="workerThreads" value="4" min="1" max="16"
                                       onchange="updateSetting('workerThreads', this.value)">
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">Configuration File</div>
                                <div class="setting-description">Raw configuration in JSON format</div>
                                <textarea class="form-control" id="rawConfig" rows="8" 
                                          onchange="updateRawConfig()"></textarea>
                                <div class="mt-2">
                                    <button class="btn btn-outline-primary btn-sm" onclick="formatConfig()">
                                        <i class="fas fa-align-left me-1"></i>Format JSON
                                    </button>
                                    <button class="btn btn-outline-warning btn-sm" onclick="validateConfig()">
                                        <i class="fas fa-check me-1"></i>Validate
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Import Settings Modal -->
    <div class="modal fade" id="importModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Import Settings</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="settingsFile" class="form-label">Select settings file:</label>
                        <input type="file" class="form-control" id="settingsFile" accept=".json">
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="mergeSettings">
                        <label class="form-check-label" for="mergeSettings">
                            Merge with existing settings (uncheck to replace all)
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="performImport()">Import</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        let currentSettings = {};
        let settingsModified = false;
        
        // Initialize settings
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            loadStorageStatus();
            loadBackupList();
        });
        
        function loadSettings() {
            fetch('/api/settings')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        currentSettings = data.settings;
                        populateSettings(currentSettings);
                    } else {
                        console.error('Failed to load settings:', data.error);
                    }
                })
                .catch(error => {
                    console.error('Error loading settings:', error);
                });
        }
        
        function populateSettings(settings) {
            // Populate form fields with current settings
            Object.keys(settings).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = settings[key];
                    } else {
                        element.value = settings[key];
                    }
                }
            });
            
            // Update raw config textarea
            document.getElementById('rawConfig').value = JSON.stringify(settings, null, 2);
            
            // Update compression display
            updateCompressionDisplay(settings.compressionLevel || 5);
        }
        
        function updateSetting(key, value) {
            currentSettings[key] = value;
            settingsModified = true;
            
            // Auto-save after 2 seconds of inactivity
            clearTimeout(window.autoSaveTimeout);
            window.autoSaveTimeout = setTimeout(() => {
                saveSettings();
            }, 2000);
        }
        
        function updateShimmerSensors() {
            const sensors = [];
            if (document.getElementById('shimmerGSR').checked) sensors.push('GSR');
            if (document.getElementById('shimmerAccel').checked) sensors.push('Accelerometer');
            if (document.getElementById('shimmerECG').checked) sensors.push('ECG');
            
            updateSetting('shimmerEnabledSensors', sensors);
        }
        
        function updateCompressionDisplay(value) {
            const display = document.getElementById('compressionValue');
            const levels = ['Very Low', 'Low', 'Low-Medium', 'Medium-Low', 'Medium', 'Medium-High', 'High-Medium', 'High', 'Very High', 'Maximum'];
            display.textContent = `${levels[value - 1]} (${value})`;
        }
        
        function updateRawConfig() {
            try {
                const rawConfig = document.getElementById('rawConfig').value;
                const parsed = JSON.parse(rawConfig);
                currentSettings = parsed;
                populateSettings(currentSettings);
                settingsModified = true;
            } catch (error) {
                alert('Invalid JSON format: ' + error.message);
            }
        }
        
        function formatConfig() {
            try {
                const rawConfig = document.getElementById('rawConfig').value;
                const parsed = JSON.parse(rawConfig);
                document.getElementById('rawConfig').value = JSON.stringify(parsed, null, 2);
            } catch (error) {
                alert('Invalid JSON format: ' + error.message);
            }
        }
        
        function validateConfig() {
            try {
                const rawConfig = document.getElementById('rawConfig').value;
                JSON.parse(rawConfig);
                alert('Configuration is valid!');
            } catch (error) {
                alert('Invalid JSON format: ' + error.message);
            }
        }
        
        function saveSettings() {
            fetch('/api/settings', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(currentSettings)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    settingsModified = false;
                    showNotification('Settings saved successfully', 'success');
                } else {
                    showNotification('Failed to save settings: ' + data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error saving settings:', error);
                showNotification('Error saving settings', 'error');
            });
        }
        
        function saveAllSettings() {
            saveSettings();
        }
        
        function resetToDefaults() {
            if (confirm('Are you sure you want to reset all settings to defaults? This cannot be undone.')) {
                fetch('/api/settings/reset', {
                    method: 'POST'
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        loadSettings();
                        showNotification('Settings reset to defaults', 'success');
                    } else {
                        showNotification('Failed to reset settings: ' + data.error, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error resetting settings:', error);
                    showNotification('Error resetting settings', 'error');
                });
            }
        }
        
        function exportSettings() {
            const dataStr = JSON.stringify(currentSettings, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `settings_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }
        
        function importSettings() {
            new bootstrap.Modal(document.getElementById('importModal')).show();
        }
        
        function performImport() {
            const fileInput = document.getElementById('settingsFile');
            const mergeSettings = document.getElementById('mergeSettings').checked;
            
            if (fileInput.files.length === 0) {
                alert('Please select a settings file');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const importedSettings = JSON.parse(e.target.result);
                    
                    if (mergeSettings) {
                        currentSettings = {...currentSettings, ...importedSettings};
                    } else {
                        currentSettings = importedSettings;
                    }
                    
                    populateSettings(currentSettings);
                    saveSettings();
                    
                    bootstrap.Modal.getInstance(document.getElementById('importModal')).hide();
                    showNotification('Settings imported successfully', 'success');
                } catch (error) {
                    alert('Invalid settings file: ' + error.message);
                }
            };
            
            reader.readAsText(file);
        }
        
        function loadStorageStatus() {
            fetch('/api/settings/storage-status')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const status = data.storage;
                        document.getElementById('totalSpace').textContent = formatBytes(status.total);
                        document.getElementById('usedSpace').textContent = formatBytes(status.used);
                        document.getElementById('freeSpace').textContent = formatBytes(status.free);
                        
                        const usagePercent = (status.used / status.total) * 100;
                        const progressBar = document.getElementById('storageProgressBar');
                        progressBar.style.width = usagePercent + '%';
                        
                        if (usagePercent > 90) {
                            progressBar.className = 'progress-bar bg-danger';
                        } else if (usagePercent > 75) {
                            progressBar.className = 'progress-bar bg-warning';
                        } else {
                            progressBar.className = 'progress-bar bg-success';
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading storage status:', error);
                });
        }
        
        function loadBackupList() {
            fetch('/api/settings/backups')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        displayBackupList(data.backups);
                    }
                })
                .catch(error => {
                    console.error('Error loading backup list:', error);
                });
        }
        
        function displayBackupList(backups) {
            const backupList = document.getElementById('backupList');
            
            if (backups.length === 0) {
                backupList.innerHTML = '<p class="text-muted">No backups found</p>';
                return;
            }
            
            backupList.innerHTML = backups.slice(0, 5).map(backup => `
                <div class="backup-item">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <strong>${backup.name}</strong>
                            <br>
                            <small class="text-muted">${formatDate(backup.date)} - ${formatBytes(backup.size)}</small>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-outline-primary me-1" onclick="downloadBackup('${backup.name}')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteBackup('${backup.name}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function createBackup() {
            fetch('/api/settings/backup', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    loadBackupList();
                    showNotification('Backup created successfully', 'success');
                } else {
                    showNotification('Failed to create backup: ' + data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error creating backup:', error);
                showNotification('Error creating backup', 'error');
            });
        }
        
        function restoreBackup() {
            // This would open a file picker for backup files
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json,.zip';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const formData = new FormData();
                    formData.append('backup', file);
                    
                    fetch('/api/settings/restore', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            loadSettings();
                            showNotification('Backup restored successfully', 'success');
                        } else {
                            showNotification('Failed to restore backup: ' + data.error, 'error');
                        }
                    })
                    .catch(error => {
                        console.error('Error restoring backup:', error);
                        showNotification('Error restoring backup', 'error');
                    });
                }
            };
            input.click();
        }
        
        function downloadBackup(backupName) {
            window.open(`/api/settings/backup/${backupName}/download`);
        }
        
        function deleteBackup(backupName) {
            if (confirm(`Are you sure you want to delete backup "${backupName}"?`)) {
                fetch(`/api/settings/backup/${backupName}`, {
                    method: 'DELETE'
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        loadBackupList();
                        showNotification('Backup deleted successfully', 'success');
                    } else {
                        showNotification('Failed to delete backup: ' + data.error, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error deleting backup:', error);
                    showNotification('Error deleting backup', 'error');
                });
            }
        }
        
        function browseStoragePath() {
            // This would open a directory picker
            fetch('/api/settings/browse-directory', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ type: 'storage' })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.path) {
                    document.getElementById('storagePath').value = data.path;
                    updateSetting('storagePath', data.path);
                }
            })
            .catch(error => {
                console.error('Error browsing directory:', error);
            });
        }
        
        function browseBackupPath() {
            // This would open a directory picker
            fetch('/api/settings/browse-directory', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ type: 'backup' })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.path) {
                    document.getElementById('backupPath').value = data.path;
                    updateSetting('backupPath', data.path);
                }
            })
            .catch(error => {
                console.error('Error browsing directory:', error);
            });
        }
        
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.settings-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            document.getElementById(sectionName + 'Section').style.display = 'block';
            
            // Update navigation
            document.querySelectorAll('.settings-nav .nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            event.target.classList.add('active');
        }
        
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `alert alert-${type === 'success' ? 'success' : 'danger'} alert-dismissible fade show`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 5000);
        }
        
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function formatDate(dateString) {
            return new Date(dateString).toLocaleString();
        }
        
        // Warn user about unsaved changes
        window.addEventListener('beforeunload', function(e) {
            if (settingsModified) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>